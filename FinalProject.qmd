---
title: "Final Project"
author: "Adriana Vance, Kyle Kim, Elena Koshkin, Kamiryn Rose"
format: html
editor: visual
---

#### Loading Data Sets

```{r echo = false}
library(httr)
library(jsonlite)
library(tidyverse)
library(tidycensus)
library(purrr)
library(sf)

#Read in CSV of CDC data
Health <- read_csv("PLACES.csv")

# Look at types of health outcome measures
Measures <- Health %>%
  group_by(Measure) %>%
  summarize(n = n())

MeasureIDs <- Health %>%
  group_by(MeasureId) %>%
  summarize(n = n())

# We want to look for current rates of asthma, heart disease, diabetes, stroke, and depression
Health <- Health %>%
  filter(
    MeasureId == "CASTHMA" |
      MeasureId == "CHD" |
      MeasureId == "DIABETES" |
      MeasureId == "STROKE" |
      MeasureId == "DEPRESSION")

ACSData <- load_variables(2021, "acs5") #browse to find variables
      
# Loading ACS Data (not working right now)
my_vars <- c(median_cost_ratio = "B25071_001E")


DC <- get_acs(geography = "tract",
                     variables = my_vars,
                     state = "DC", 
                     output = "wide",
                     survey = "acs5",
                     year = 2021,
                     geometry = TRUE)

MD <- get_acs(geography = "tract",
                     variables = my_vars,
                     state = "MD",
                     county = c("Montgomery", "Prince George's"),
                     output = "wide",
                     survey = "acs5",
                     year = 2021,
                     geometry = TRUE)

VA <- get_acs(geography = "tract",
                     variables = my_vars,
                     state = "VA",
                     county = "Fairfax County",
                     output = "wide",
                     survey = "acs5",
                     year = 2021,
                     geometry = TRUE)

All_states <- bind_rows(DC, MD, VA)


```

#### Playing around w mapping

```{r}
# Change geometry to be readable by SF

Health_map <- Health_filter %>%
  st_as_sf(wkt = "Geolocation", remove = FALSE) %>%
  st_set_crs(value = 4326) # setting CRS

# Map health outcomes
Health_map %>%
  ggplot() +
  geom_sf(aes(color = MeasureId))

```
## loading in Capital Flows Dataset 
```{r}
library(readxl)
capital_flows <- read_excel("capital_flows.xlsx", 3) %>%
  filter(in_DMV == "TRUE")
view(capital_flows)
```

## loading in Medical Debt Dataset
```{r}
medical_debt <- read_excel("medical_debt.xlsx") 

# need to filter to Maryalnd, Virginia, and DC but the column names have spaces 
view(medical_debt)
```


